
\section{Hypothesen}
\label{Sec:Hypothesen}
In Anbetracht der Fragestellung lassen sich schon im Vorfeld einige Vermutungen anstellen, die im Folgenden dargelegt werden sollen.
\subsection{PE-File Korruption} 
\textit{Mehr als 25\% der mehrfach obfuskierten PE Files sind korrumpiert und nicht ausführbar.} 
Der Hintergrund dieser Hypothese ist, dass es Belege dafür gibt, dass ML-AV Scanner besonders auf die Hinweise auf Obfuskation anschlagen \cite{nunes_2022_bane}. Außerdem erhöhen Obfuskatoren die inhärente Entropie innerhalb eines Files und vergrößern diese. Größere Files werden erfahrungsgemäß eher von AV Software gefunden \footnote{Red-Team Erfahrungsbericht}. Ebenso hat sich aus der Praxis gezeigt, dass ein geringer Anteil der Output-Dateien der Obfuskatoren nicht ausführbar sind.
Dies kann potenziell an Bugs in den Tools liegen, die mit dem PE File Format arbeiten müssen, welches durch seine strenge Fileformat Struktur sehr anfällig für änderungsbedingte Korruption ist. Die Kombination aus mehreren Obfuskationsschritten wird voraussichtlich damit zu einer geringeren Erfolgsquote bzw. zu einem höheren Fehleranteil führen.
Um diese Hypothese zu prüfen, werden nach dem Ausführen des Genetischen Algorithmus die erzeugten Dateien aufgeteilt in die Gruppen von 'Erfolgreich Evaded', 'Nicht Erfolgreich Evaded' mit den Untergruppen: 'nicht ausführbar' und 'von AV Scanner erkannt'. Diese Aufteilung wird für jede Inputdatei einzeln durchgeführt und die Hypothese dann anhand der Ergebnisse überprüft.
%\subsection{Geringe Shellcode Korrumpierung}
%\textit{Mehrfach obfuskierter Shellcode ist in weniger Fällen als die PE Files korrumpiert und nicht ausführbar.}
%Hier wird davon ausgegangen, dass der Shellcode an sich schon signifikant kleiner ist als ein PE File und eine kleine Veränderung in einer Operation nicht zwangsläufig die Veränderung des gesamten Files korrumpiert. Zur Testung der Hypothese werden die Daten, die für Hypothese 1 gesammelt werden, verglichen mit denen, die aus einem gleichartigen Experiment mit Shellcode durchgeführt werden.
\subsection{Red-Teaming Kriterien Erfüllung}
\textit{Der vorgeschlagene Genetische Algorithmus ist in der Lage, die Anforderungen an Laufzeit und Ergebnisse des Red-Teamings zu erfüllen.}
Naturgemäß soll das vorgestellte Tool ObscurusEvolution die Anforderungen des Red-Teamings bewältigen können und einen Mehrwert für die praktische Arbeit liefern. Deshalb soll diskutiert werden, inwieweit die Kriterien aus \ref{Methode:Kriterien} von den Beobachtungen erfüllt werden können.
\subsection{Einfluss der Länge von Obfuskatorkaskaden}
\textit{Die Anzahl der Obfuskationsschritte hat einen Einfluss auf die Erkennungswahrscheinlichkeit der Payload.} Es wird vermutet, dass es einen systematischen Unterschied bei der Leistung zwischen der Anzahl an verwendeten Obfuskationsschritten gibt. So lässt sich aus Hypothesen 1 und 2 vermuten, dass die Erfolgswahrscheinlichkeit für mehr Schritte sinkt, da es häufiger zu Fehlern kommen kann und die Datei (unnötig) größer wird. Diese Hypothese soll qualitativ überprüft werden und erste Einordnungen ermöglichen, welche Faktoren die optimale Anzahl an Obfuskationsschritten beeinflussen.
